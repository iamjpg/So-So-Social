/******************************************************
	* jQuery plug-in
	* So So Social Activity Feed
	* Services accessed: Facebook, Delicious, Twitter, Last.FM, Flickr
	* Developed by J.P. Given (http://johnpatrickgiven.com)
	* Useage: anyone so long as credit is left alone
******************************************************/
var sss={};sss.ACTIVITY_ARRAY=new Array();sss.TWITTER_FINISHED=0;sss.FACEBOOK_FINISHED=0;sss.FLICKR_FINISHED=0;sss.LASTFM_FINISHED=0;sss.DELICIOUS_FINISHED=0;sss.TUMBLR_FINISHED=0;sss.WORDPRESS_FINISHED=0;sss.POSTEROUS_FINISHED=0;sss.CONTAINER=null;sss.COUNT=0;(function(a){a.fn.soSoSocial=function(b){sss.CONTAINER=a(this);if(sss.TWITTER_RSS!=""){a.getJSON("http://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20xml%20where%20url%3D%22"+encodeURIComponent(sss.TWITTER_RSS)+"%22&format=json&callback=?",function(c){if(c.query.results.rss){a(c.query.results.rss.channel.item).each(function(){var h=this.title;var f=this.link;var e=this.description;var g=this.pubDate;g=g.replace(/\,/g,"");var d=h.replace(/((https?|s?ftp|ssh)\:\/\/[^"\s\<\>]*[^.,;'">\:\s\<\>\)\]\!])/g,function(i){return'<a href="'+i+'">'+i+"</a>";}).replace(/\B@([_a-z0-9]+)/ig,function(i){return i.charAt(0)+'<a href="http://twitter.com/'+i.substring(1)+'">'+i.substring(1)+"</a>";});d="@"+d;d=d.replace(/\B@([_a-z0-9]+):/ig,"");sss.ACTIVITY_ARRAY[sss.COUNT]=new Array();sss.ACTIVITY_ARRAY[sss.COUNT][0]='<li style="background: url(http://farm5.static.flickr.com/4057/4494661441_c03e3fe766_o.png) no-repeat left center;">'+d+' <a href="'+f+'" target="_blank">#</a>';sss.ACTIVITY_ARRAY[sss.COUNT][1]=relative_time(g);sss.ACTIVITY_ARRAY[sss.COUNT][2]=get_delta(g);sss.COUNT++;});sss.TWITTER_FINISHED=1;}else{console.log("SoSoSocial ERROR: Twitter feed seems to be down.");sss.TWITTER_FINISHED=1;}});}else{sss.TWITTER_FINISHED=1;}if(sss.LASTFM_RSS!=""){a.getJSON("http://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20xml%20where%20url%3D%22"+encodeURIComponent(sss.LASTFM_RSS)+"%22&format=json&callback=?",function(c){if(c.query.results.rss){a(c.query.results.rss.channel.item).each(function(){var g=this.title;var e=this.link;var d=this.description;var f=this.pubDate;f=f.replace(/\,/g,"");sss.ACTIVITY_ARRAY[sss.COUNT]=new Array();sss.ACTIVITY_ARRAY[sss.COUNT][0]='<li style="background: url(http://farm5.static.flickr.com/4007/4495300744_5c8afb3149_o.png) no-repeat left center;">Listened to <a href="'+e+'" target="_blank">'+g+"</a>";sss.ACTIVITY_ARRAY[sss.COUNT][1]=relative_time(f);sss.ACTIVITY_ARRAY[sss.COUNT][2]=get_delta(f);sss.COUNT++;});sss.LASTFM_FINISHED=1;}else{console.log("SoSoSocial ERROR: LastFM feed seems to be down.");sss.LASTFM_FINISHED=1;}});}else{sss.LASTFM_FINISHED=1;}if(sss.FACEBOOK_RSS!=""){a.getJSON("http://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20xml%20where%20url%3D%22"+encodeURIComponent(sss.FACEBOOK_RSS)+"%22&format=json&callback=?",function(c){if(c.query.results.rss){a(c.query.results.rss.channel.item).each(function(){var g=this.title;var e=this.link;var d=this.description;var f=this.pubDate;f=f.replace(/\,/g,"");sss.ACTIVITY_ARRAY[sss.COUNT]=new Array();sss.ACTIVITY_ARRAY[sss.COUNT][0]='<li style="background: url(http://farm5.static.flickr.com/4022/4494661487_35b0167583_o.png) no-repeat left center;">Posted <a href="'+e+'" target="_blank">'+g+"</a>";sss.ACTIVITY_ARRAY[sss.COUNT][1]=relative_time(f);sss.ACTIVITY_ARRAY[sss.COUNT][2]=get_delta(f);sss.COUNT++;});sss.FACEBOOK_FINISHED=1;}else{console.log("SoSoSocial ERROR: Facebook feed seems to be down.");sss.FACEBOOK_FINISHED=1;}});}else{sss.FACEBOOK_FINISHED=1;}if(sss.FLICKR_RSS!=""){a.getJSON("http://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20xml%20where%20url%3D%22"+encodeURIComponent(sss.FLICKR_RSS)+"%22&format=json&callback=?",function(c){if(c.query.results.rss){a(c.query.results.rss.channel.item).each(function(){var g=this.title;var e=this.link;var d=this.description;var f=this.pubDate;f=f.replace(/\,/g,"");g=g.toString();g=g.split(",");g=g[0];sss.ACTIVITY_ARRAY[sss.COUNT]=new Array();sss.ACTIVITY_ARRAY[sss.COUNT][0]='<li style="background: url(http://farm3.static.flickr.com/2727/4494661413_0228be5f32_o.png) no-repeat left center;">Uploaded <a href="'+e+'" target="_blank">'+g+"</a>";sss.ACTIVITY_ARRAY[sss.COUNT][1]=relative_time(f);sss.ACTIVITY_ARRAY[sss.COUNT][2]=get_delta(f);sss.COUNT++;});sss.FLICKR_FINISHED=1;}else{console.log("SoSoSocial ERROR: Flickr feed seems to be down.");sss.FLICKR_FINISHED=1;}});}else{sss.FLICKR_FINISHED=1;}if(sss.DELICIOUS_RSS!=""){a.getJSON("http://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20xml%20where%20url%3D%22"+encodeURIComponent(sss.DELICIOUS_RSS)+"%22&format=json&callback=?",function(c){if(c.query.results.rss){a(c.query.results.rss.channel.item).each(function(){var g=this.title;var e=this.link;var d=this.description;var f=this.pubDate;f=f.replace(/\,/g,"");sss.ACTIVITY_ARRAY[sss.COUNT]=new Array();sss.ACTIVITY_ARRAY[sss.COUNT][0]='<li style="background: url(http://farm5.static.flickr.com/4064/4495300640_2a7cbbb922_o.png) no-repeat left center;">Saved <a href="'+e+'" target="_blank">'+g+"</a>.";sss.ACTIVITY_ARRAY[sss.COUNT][1]=relative_time(f);sss.ACTIVITY_ARRAY[sss.COUNT][2]=get_delta(f);sss.COUNT++;});sss.DELICIOUS_FINISHED=1;}else{console.log("SoSoSocial ERROR: Delicious feed seems to be down.");sss.DELICIOUS_FINISHED=1;}});}else{sss.DELICIOUS_FINISHED=1;}print_array(a(this));if(typeof b=="function"){b.call(this);}if(sss.TUMBLR_RSS!=""){a.getJSON("http://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20xml%20where%20url%3D%22"+encodeURIComponent(sss.TUMBLR_RSS)+"%22&format=json&callback=?",function(c){if(c.query.results.rss){}else{console.log("SoSoSocial ERROR: Facebook feed seems to be down.");sss.FACEBOOK_FINISHED=1;}a(c.query.results.rss.channel.item).each(function(){var g=this.title;var e=this.link;var d=this.description;var f=this.pubDate;f=f.replace(/\,/g,"");sss.ACTIVITY_ARRAY[sss.COUNT]=new Array();sss.ACTIVITY_ARRAY[sss.COUNT][0]='<li style="background: url(http://farm5.static.flickr.com/4022/4494661551_3d68321873_o.png) no-repeat left center;">Posted <a href="'+e+'" target="_blank">'+g+"</a>.";sss.ACTIVITY_ARRAY[sss.COUNT][1]=relative_time(f);sss.ACTIVITY_ARRAY[sss.COUNT][2]=get_delta(f);sss.COUNT++;});sss.TUMBLR_FINISHED=1;});}else{sss.TUMBLR_FINISHED=1;}print_array(a(this));if(typeof b=="function"){b.call(this);}if(sss.WORDPRESS_RSS!=""){a.getJSON("http://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20xml%20where%20url%3D%22"+encodeURIComponent(sss.WORDPRESS_RSS)+"%22&format=json&callback=?",function(c){if(c.query.results.rss){a(c.query.results.rss.channel.item).each(function(){var g=this.title;var e=this.link;var d=this.description;var f=this.pubDate;f=f.replace(/\,/g,"");sss.ACTIVITY_ARRAY[sss.COUNT]=new Array();sss.ACTIVITY_ARRAY[sss.COUNT][0]='<li style="background: url(http://farm5.static.flickr.com/4060/4495300842_3f39a6b514_o.png) no-repeat left center;">Posted <a href="'+e+'" target="_blank">'+g+"</a> on Wordpress.";sss.ACTIVITY_ARRAY[sss.COUNT][1]=relative_time(f);sss.ACTIVITY_ARRAY[sss.COUNT][2]=get_delta(f);sss.COUNT++;});sss.WORDPRESS_FINISHED=1;}else{console.log("SoSoSocial ERROR: Wordpress feed seems to be down.");sss.WORDPRESS_FINISHED=1;}});}else{sss.WORDPRESS_FINISHED=1;}print_array(a(this));if(typeof b=="function"){b.call(this);}if(sss.POSTEROUS_RSS!=""){a.getJSON("http://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20xml%20where%20url%3D%22"+encodeURIComponent(sss.POSTEROUS_RSS)+"%22&format=json&callback=?",function(c){if(c.query.results.rss){a(c.query.results.rss.channel.item).each(function(){var g=this.title;var e=this.link;var d=this.description;var f=this.pubDate;f=f.replace(/\,/g,"");sss.ACTIVITY_ARRAY[sss.COUNT]=new Array();sss.ACTIVITY_ARRAY[sss.COUNT][0]='<li style="background: url(http://farm5.static.flickr.com/4152/4946030629_65fece60f2_o.png) no-repeat left center;">Posted <a href="'+e+'" target="_blank">'+g+"</a> on Posterous.";sss.ACTIVITY_ARRAY[sss.COUNT][1]=relative_time(f);sss.ACTIVITY_ARRAY[sss.COUNT][2]=get_delta(f);sss.COUNT++;});sss.POSTEROUS_FINISHED=1;}else{console.log("SoSoSocial ERROR: Wordpress feed seems to be down.");sss.POSTEROUS_FINISHED=1;}});}else{sss.POSTEROUS_FINISHED=1;}print_array(a(this));if(typeof b=="function"){b.call(this);}};})(jQuery);function print_array(b){if((sss.FLICKR_FINISHED==1)&&(sss.TWITTER_FINISHED==1)&&(sss.FACEBOOK_FINISHED==1)&&(sss.LASTFM_FINISHED==1)&&(sss.DELICIOUS_FINISHED==1)&&(sss.TUMBLR_FINISHED==1)&&(sss.WORDPRESS_FINISHED==1)){if((sss.LIMIT==0)||(sss.ACTIVITY_ARRAY.length<sss.LIMIT)){sss.LIMIT=sss.ACTIVITY_ARRAY.length;}sss.CONTAINER.html("");sss.ACTIVITY_ARRAY.sort(by(2,1));var a="<ul>";for(j=0;j<sss.LIMIT;j++){a+=sss.ACTIVITY_ARRAY[j][0]+" ("+sss.ACTIVITY_ARRAY[j][1]+")</li>";}a+="</ul>";sss.CONTAINER.append(a);}else{setTimeout("print_array()",1000);}}function get_delta(c){var b=c.split(" ");c=b[2]+" "+b[1]+", "+b[3]+" "+b[4];var a=Date.parse(c);var d=(arguments.length>1)?arguments[1]:new Date();var e=parseInt((d.getTime()-a)/1000,10);if(b[5]=="+0000"){e=e+(d.getTimezoneOffset()*60);}else{e=e+d.getTimezoneOffset();}return e;}function relative_time(a){var b=get_delta(a);if(b<60){return"less than a minute ago";}else{if(b<120){return"about a minute ago";}else{if(b<(60*60)){return(parseInt(b/60,10)).toString()+" minutes ago";}else{if(b<(120*60)){return"about an hour ago";}else{if(b<(24*60*60)){return"about "+(parseInt(b/3600,10)).toString()+" hours ago";}else{if(b<(48*60*60)){return"1 day ago";}else{return(parseInt(b/86400,10)).toString()+" days ago";}}}}}}}function by(b,a){return function(d,c){d=d[b];c=c[b];return d==c?0:(d<c?-1*a:a);};}